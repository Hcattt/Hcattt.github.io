<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linux运维</title>
      <link href="2021/05/31/hello-world/"/>
      <url>2021/05/31/hello-world/</url>
      
        <content type="html"><![CDATA[<h1 id="Linux-系统部署-Java-应用"><a href="#Linux-系统部署-Java-应用" class="headerlink" title="Linux 系统部署 Java 应用"></a>Linux 系统部署 Java 应用</h1><p>服务器 Linux </p><p>阿里云、华为云、腾讯云</p><p>安装虚拟机，虚拟机就是在你的电脑中安装一台虚拟的计算机，内存、CPU、硬盘，Linux 安装到虚拟机中。</p><p>CentOS7，企业级 Linux 的发行版，完全开源，完全免费。</p><p>安装软件：</p><ul><li>虚拟机 VMware workstation 15</li><li>CentOS7</li><li>安装 Java 环境 JDK 8</li><li>安装 MySQL 8</li><li>安装 Tomcat</li><li>安装 Xshell</li><li>安装 Xftp</li></ul><h1 id="安装-VM"><a href="#安装-VM" class="headerlink" title="安装 VM"></a>安装 VM</h1><h1 id="安装-Linux-操作系统-CentOS-7"><a href="#安装-Linux-操作系统-CentOS-7" class="headerlink" title="安装 Linux 操作系统 CentOS 7"></a>安装 Linux 操作系统 CentOS 7</h1><p>1、解压 CentOS7</p><p>2、将解压之后的文件导入 VM，运行即可</p><p>3、虚拟机设置</p><p>默认的网络配置是桥接模式，直接接入当前的网络环境，如果网络不稳定，IP 会变。</p><p>NAT，相当于在 Windows 系统中独立开辟一块新的网络空间，IP 地址固定不变的，无论是否接入外网，都可以访问 CentOS。</p><p>4、启动虚拟机，用 root 权限登录</p><p>用户名：root</p><p>密码：123456</p><p>Linux 查询 IP 地址</p><pre><code>ifconfig</code></pre><h1 id="安装-JDK"><a href="#安装-JDK" class="headerlink" title="安装 JDK"></a>安装 JDK</h1><p>1、删除 CentOS 自带的 OpenJDK</p><p>2、通过 Xftp 将安装包拷贝到 CentOS 中</p><p>3、通过命令安装 JDK</p><pre><code>rpm -ivh jdk-8u221-linux-x64.rpm</code></pre><p>4、配环境变量</p><pre><code>JAVA_HOME=/usr/java/jdk/jdk1.8.0_221-amd64CLASSPATH=%JAVA_HOME%/lib:%JAVA_HOME%/jre/libPATH=$PATH:$JAVA_HOME/bin:$JAVA_HOME/jre/binexport PATH CLASSPATH JAVA_HOME</code></pre><p>5、让配置生效</p><pre><code>source /etc/profile</code></pre><h1 id="Java-Web-应用"><a href="#Java-Web-应用" class="headerlink" title="Java Web 应用"></a>Java Web 应用</h1><p>1、配置 Tomcat</p><p>2、解压缩</p><pre><code>tar -zxvf apache-tomcat-9.0.34.tar.gz</code></pre><p>3、启动 Tomcat</p><pre><code>./startup.sh</code></pre><p>4、CentOS 开放 8080 端口</p><ul><li>检查防火墙状态</li></ul><pre><code>firewall-cmd --state</code></pre><p>running 表示防火墙是开启的，如果你看到的是 not running，防火墙关闭，需要开启</p><pre><code>systemctl restart firewalld.service</code></pre><ul><li>开放 8080 端口</li></ul><pre><code>firewall-cmd --zone=public --add-port=8080/tcp --permanent</code></pre><ul><li>重启防火墙</li></ul><pre><code>systemctl restart firewalld.service</code></pre><ul><li>重新载入配置</li></ul><pre><code>firewall-cmd --reload</code></pre><h1 id="部署-Spring-Boot-应用"><a href="#部署-Spring-Boot-应用" class="headerlink" title="部署 Spring Boot 应用"></a>部署 Spring Boot 应用</h1><p>IDEA 启动 Spring Boot ，将 Spring Boot 应用打成 jar，通过命令行部署。</p><pre><code>java -jar xxx.jar</code></pre><p>1、将 Spring Boot 应用打包，jar，Maven</p><p>2、通过命令行启动 jar 即可</p><pre><code>java -jar demo.jar</code></pre><h1 id="安装-MySQL"><a href="#安装-MySQL" class="headerlink" title="安装 MySQL"></a>安装 MySQL</h1><p>1、通过 Xftp 将 MySQL 安装包拷贝到 Linux</p><p>2、解压缩</p><pre><code>tar -xvf mysql-8.0.20-1.el7.x86_64.rpm-bundle.tar </code></pre><p>3、安装 common、libs、client、server</p><p>4、删除自带的 mariadb</p><pre><code>rpm -e mariadb-libs-5.5.44-2.el7.centos.x86_64 --nodeps</code></pre><p>5、安装命令行</p><pre><code>rpm -ivh mysql-community-common-8.0.20-1.el7.x86_64.rpm --nodeps --forcerpm -ivh mysql-community-libs-8.0.20-1.el7.x86_64.rpm --nodeps --forcerpm -ivh mysql-community-client-8.0.20-1.el7.x86_64.rpm --nodeps --forcerpm -ivh mysql-community-server-8.0.20-1.el7.x86_64.rpm --nodeps --force</code></pre><p>6、初始化 MySQL</p><pre><code>mysqld --initialize</code></pre><p>7、授权防火墙</p><pre><code>chown mysql:mysql /var/lib/mysql -R;systemctl start mysqld.service;systemctl enable mysqld;</code></pre><p>8、查看数据库的初始化密码</p><pre><code>cat /var/log/mysqld.log | grep password</code></pre><p>9、登录数据库</p><pre><code>mysql -uroot -p</code></pre><p>10、修改密码</p><pre><code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;root&#39;;</code></pre><p>11、使用新密码登录</p><p>12、开启远程访问</p><pre><code>create user &#39;root&#39;@&#39;%&#39; identified with mysql_native_password by &#39;root&#39;;grant all privileges on *.* to &#39;root&#39;@&#39;%&#39; with grant option;flush privileges;</code></pre><p>13、开放 3306 端口</p><pre><code>firewall-cmd --zone=public --add-port=3306/tcp --permanentsystemctl restart firewalld.servicefirewall-cmd --reload</code></pre><p>14、MySQL 安装默认使用美国的时区，北京时间比美国晚 8 小时</p><pre><code>set global time_zone=&#39;+8:00&#39;;</code></pre><p>15、创建数据表</p><pre><code>create database test character set utf8 collate utf8_general_ci;use test;create table user(    id int primary key auto_increment,    name varchar(22),    birthday datetime);insert into user(name, birthday) VALUES (&#39;小明&#39;,&#39;1999-01-01&#39;);insert into user(name, birthday) VALUES (&#39;小红&#39;,&#39;2000-01-01&#39;);</code></pre><p>war jar</p><p>如果你使用的是 SSM 或者 Java WEB（非 Spring Boot）需要通过 war 包进行部署，先把你的应用打成 war 包，丢到外置的 Tomcat 中，启动 Tomcat 服务，进而访问你的应用。</p><p>如果你使用的是 Spring Boot，内置了 Tomcat，直接用 jar 部署，使用命令启动即可</p><pre><code>java -jar demo.jar</code></pre><h1 id="centOS运行spring-boot程序"><a href="#centOS运行spring-boot程序" class="headerlink" title="centOS运行spring boot程序"></a>centOS运行spring boot程序</h1><pre><code>java -jar work3-0.0.1-SNAPSHOT.jarjava -jar work3-0.0.1-SNAPSHOT.jar --server.port=80 #指定在80端口运行ctrl + c 停止运行</code></pre><p>后台运行</p><p>1 starpup.sh  (启动)</p><pre><code>#!bin/shnohup java -jar /usr/local/java/myproject/work3-0.0.1-SNAPSHOT.jar &amp;         </code></pre><p>2 关闭进程stop.sh</p><pre class=" language-java"><code class="language-java">#<span class="token operator">!</span><span class="token operator">/</span>bin<span class="token operator">/</span>bashPID<span class="token operator">=</span>$<span class="token punctuation">(</span>ps <span class="token operator">-</span>ef <span class="token operator">|</span> grep work3<span class="token operator">-</span><span class="token number">0.0</span><span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">-</span>SNAPSHOT<span class="token punctuation">.</span>jar<span class="token punctuation">.</span>jar <span class="token operator">|</span> grep <span class="token operator">-</span>v grep <span class="token operator">|</span> awk <span class="token string">'&amp;#123; print $2 &amp;#125;'</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">-</span>z <span class="token string">"$PID"</span> <span class="token punctuation">]</span>then    echo Application is already stopped<span class="token keyword">else</span>    echo kill $PID    kill $PIDfi________________________________________ps <span class="token operator">-</span>ef<span class="token operator">|</span>grep java  #查看带Java的进程kill  pid</code></pre><p>3 重启服务  reboot.sh</p><pre><code>#!/bin/bashecho stop applicationsource stop.shecho start applicationsource startup.sh</code></pre><p>4 添加可执行权限</p><pre><code>chmod +x start.shchmod +x stop.shchmod +x run.sh</code></pre><p>5  netstat -ntpl|grep java   查看正在运行</p><p>6 firewall-cmd –list-ports 防火墙开启的端口号</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
